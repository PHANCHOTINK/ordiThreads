#include"img-trnsfrt.h"
#include<string.h>
#include<stdio.h>
char txt[] ="749440181.510443 9.4436 smtp 1491 58 22 133.144.224.2 SF \
749440182.865991 7.75695 X.500DSA 748 262 20 128.86.8.55 SF \
749440184.173492 0.307 priN er 14 62 6 128.55.240.128 SF \
749440184.813930 ? smtp ? ? 5 134.6.34.200 S0 L \
749440187.282361 1324.51 ftp 1127 3579 380 130.43.2.3 RSTRS3 L \
749440189.819962 1.37979 ftp-data 1012 0 380 130.43.2.3 SF \
749440190.435858 0.87252 smtp 383 329 39 128.165.23.9 SF L \
749440192.989621 2.41874 smtp 3387 477 39 128.165.5.12 SF \
749440193.412865 4.53078 smtp 910 260 5 129.74.250.101 SF L \
749440194.716145 3.62181 ftp-data 1340 0 380 130.43.2.3 SF \
749440198.244191 287.182 N N  p 195453 1248 2 128.32.155.1 RSTOS2 N \
749440206.312082 ? smtp ? ? 5 144.206.136.1 S0 L \
749440206.505396 0.690484 ftp-data 302 0 380 130.43.2.3 SF \
749440206.914459 1.23006 ftp 0 73 50 128.252.135.4 SF L \
749440211.998816 3.72373 N  p 521 135 4 128.32.149.36 SF N \
749440214.459803 195.92 N  p 76783 1200 4 128.49.4.103 SF L \
749440217.938332 3.61373 fiN er 9 623 5 147.222.2.2 SF \
749440218.523448 0.719967 ftp-data 289 0 380 130.43.2.3 SF \
749440219.227009 3.28208 smtp 604 283 5 192.58.194.73 SF L \
749440220.237200 122.238 teL  t 3 175 12 192.35.222.222 SF L \
749440221.326532 4.71666 smtp 3245 373 5 147.122.1.21 SF \
749440224.779475 ? smtp ? ? 166 131.108.62.192 S0 L \
749440226.067940 3.61479 smtp 3196 336 43 147.122.1.21 SF \
749440228.512672 0.64776 ftp-data 169 0 380 130.43.2.3 SF \
749440229.762946 3.2623 smtp 3200 340 101 147.122.1.21 SF \
749440233.087362 41.8739 smtp 3331 640 6 147.122.1.21 SF \
749440233.291058 ? smtp ? ? 1292 132.239.254.201 S0 \
749440238.500138 1.19763 ftp-data 943 0 380 130.43.2.3 SF \
749440239.438215 12.8662 smtp 2047 350 5 192.26.119.4 SF L \
749440249.234654 1.81672 smtp 1273 316 5 128.186.7.19 SF \
749440250.953350 4.86321 smtp 1273 328 1 128.186.7.19 SF \
749440251.564819 0.600709 ftp-data 89 0 380 130.43.2.3 SF \
749440254.903878 832.882 teL  t 127 11129 10 128.189.32.22 SF L \
749440254.966622 ? smtp ? ? 77 130.198.127.32 S0 L \
749440259.015937 1.08683 ftp-data 583 0 380 130.43.2.3 SF \
749440265.078910 2.34148 smtp 2015 309 5 128.146.36.2 SF \
749440266.898855 1.3199 smtp 3418 334 8 36.21.0.96 SF \
749440267.969731 3.82459 N  p 399 120 4 128.32.149.36 SF N \
749440269.332212 599.908 L giN 337 6487 245 130.199.80.5 SF L \
749440277.237552 5.06857 smtp 18683 383 11 131.111.84.16 SF L \
749440281.519237 1.05321 smtp 967 63 5 134.9.48.7 SF L \
749440286.534513 175.954 teL  t 3 175 12 192.35.222.222 SF L \
749440286.608176 175.854 teL  t 3 175 12 192.35.222.222 SF L \
749440286.621298 1.1891 teL  t 3 175 12 192.35.222.222 SF L \
749440287.124972 0.71089 ftp-data 238 0 380 130.43.2.3 SF \
749440287.640592 174.852 teL  t 3 176 12 192.35.222.222 SF L \
749440289.319397 16.962 smtp 351 237 39 134.79.16.23 SF L \
749440303.912116 ? smtp ? ? 5 134.6.34.200 S0 L \
749440304.108517 1.03315 ftp-data 571 0 380 130.43.2.3 SF \
749440326.333293 ? smtp ? ? 1154 192.48.153.1 S0 \
749440328.563164 189.195 N  p 217342 1121 2 128.15.32.6 SF  L \
749440330.078094 2.70296 N  p 451 125 4 128.32.149.36 SF  N \
749440333.294918 10.147 X.500DSA 737 262 20 128.86.8.55 SF \
749440333.548022 193.599 N  p 216016 1070 4 128.32.155.1 RSTOS2 N \
749440335.743488 196.041 N  p 117708 1200 4 128.49.4.103 SF  L \
749440336.982754 138.86 N  p 116936 1172 4 128.110.4.25 SF  L \
749440338.562745 7.3035 smtp 604 283 5 192.58.194.73 SF  L \
749440340.999960 3.59181 smtp 1060 59 206 131.172.2.2 SF \
749440346.583461 175.899 teL  t 3 175 12 192.35.222.222 SF L \
749440346.699510 175.758 teL  t 3 175 12 192.35.222.222 SF L \
749440347.594369 174.863 teL  t 3 175 12 192.35.222.222 SF L \
749440351.113426 9.55271 domaiN 54 461913 15 128.165.4.4 SF \
749440361.515113 2.69304 smtp 11676 303 5 147.225.1.51 SF \
749440365.562282 0.202677 domaiN 33 81 15 128.165.144.1 SF L \
749440365.583922 0.201122 domaiN 34 86 15 128.165.32.21 SF L \
749440365.697999 0.176148 domaiN 44 113 15 128.165.196.1 SF L \
749440365.751056 0.152748 domaiN 44 113 15 128.165.196.1 SF L \
749440366.452205 0.149042 domaiN 44 113 15 128.165.196.1 SF L \
749440366.644311 0.204073 domaiN 43 105 15 146.137.48.99 SF L \
749440366.657028 0.249215 domaiN 31 97 15 130.202.20.5 SF L \
749440366.973880 0.277563 domaiN 43 105 15 146.137.48.99 SF L \
749440367.381959 0.258514 domaiN 32 92 15 130.202.20.5 SF L \
749440367.504322 0.226742 domaiN 43 105 15 146.137.48.99 SF L \
749440367.671810 0.198951 domaiN 43 105 15 146.137.48.99 SF L \
749440368.255016 0.197111 domaiN 44 106 15 146.137.48.99 SF L \
749440368.386280 0.1874 domaiN 44 106 15 146.137.48.99 SF L \
749440368.391371 0.305118 domaiN 40 106 15 130.202.20.5 SF L \
749440368.429156 0.219532 domaiN 44 106 15 146.137.48.99 SF L \
749440369.045711 0.210938 domaiN 39 99 15 130.202.20.5 SF L \
749440369.261123 0.221679 domaiN 42 108 15 130.202.20.5 SF L \
749440369.527850 0.218967 domaiN 42 108 15 130.202.20.5 SF L \
749440369.594363 0.220976 domaiN 42 108 15 130.202.20.5 SF L \
749440369.696971 0.221241 domaiN 42 108 15 130.202.20.5 SF L \
749440372.194307 3.21394 smtp 604 283 5 192.58.194.73 SF L \
749440380.768254 596.824 N  p 164224 1710 2 128.115.14.1 SF L \
749440388.198190 4.97591 N  p 384 120 4 128.32.149.36 SF N \
749440391.199515 16.9231 smtp 800 315 1 157.7.1.2 SF L \
749440396.736923 249.862 N  p 3845 1560 2 128.32.155.1 SF L  \
749440396.851499 2.74361 smtp 1381 356 100 128.151.161.119 SF \
749440398.881355 ? smtp ? ? 16 192.203.190.83 S0 L \
749440399.636230 1685.56 ftp 2263 7513 29 192.156.196.1 SF \
749440409.148749 0.520687 ftp-data 2124 0 29 192.156.196.1 SF L \
749440410.174150 5887.22 L giN 6789 159082 612 128.8.128.45 SF L \
749440429.330847 0.331961 ftp-data 607 0 29 192.156.196.1 SF L \
749440429.667333 2.78372 smtp 1449 58 22 130.43.2.6 SF \
749440431.795075 2.81672 smtp 1353 58 22 130.43.2.6 SF \
749440431.991186 1.97035 smtp 1488 59 206 130.43.2.6 SF \
749440434.962395 0.182383 ftp-data 349 0 29 192.156.196.1 SF L \
749440441.078538 0.259413 priN er 14 62 6 128.55.240.128 SF";

void main(){
    int udb_buf_count,udp_buf_len;
    char ** buffers = to_udp_buffer(txt,strlen(txt),200,75,123456789,500, 
                    &udb_buf_count,&udp_buf_len,0);
    seq_img img;
    partial_img p_img;
    read_from_udp(&p_img,buffers[0],udp_buf_len);
    init_partial_img(&img,&p_img);
    
    for (int i=0;i<udb_buf_count;i++){
        read_from_udp(&p_img,buffers[i],udp_buf_len);
        
        add_partial_img(&img,&p_img);
    }

    printf("%s",img.img);
}


